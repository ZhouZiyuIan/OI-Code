+ ## 题目描述

  小 C 给你了一棵以 $1$ 为根的二叉树，有三种操作：

  1. 给节点 $x$ 的 `lazytag` 加 $y$。
  2. 下传节点 $x$ 的 `lazytag`（下传定义见下面），保证此时下传一定正确。
  3. 小 C 会从上往下依次下传所有点 `lazytag`，但是，对于值为 $w$ 的 `lazytag`，下传时会有 $\frac{1}{w+1}$ 的概率出错，但如果 $w$ 为 $0$ 那么一定不会出错。小 C 想知道编号为 $x$ 的点，它的父亲全部下传完后，它的 `lazytag` 正确的概率。注意，查询完后要还原所有 `lazytag`。

  >**下传定义：**  
  >对于一个节点 $x$ 的 `lazytag`，如果要下传，就先把左右儿子的 `lazytag` 都加上它的 `lazytag`，最后把它的 `lazytag` 清空。举个例子：
  >
  >+ 下传前：
  >
  >```
  >x 的 lazytag：1
  >左右儿子的 lazytag：2 4
  >```
  >
  >+ 下传后：
  >
  >```
  >x 的 lazytag：0
  >左右儿子的 lazytag：3 5
  >```

  ## 输入格式

  第一行两个整数 $n,m$，代表节点数和操作数。

  接下来 $n$ 行，每行两个整数，代表每个节点的左右儿子，为零代表没有这个儿子。

  接下来 $m$ 行，每行为以下形式之一：

  + `1 x y`：表示给节点 $x$ 的 `lazytag` 加 $y$。
  + `2 x`：表示下传节点 $x$ 的 `lazytag`。
  + `3 x`：表示查询节点 $x$ 的 `lazytag` 正确的概率。

  ## 输出格式

  对于每个 `3 x` 操作，输出答案，保留六位小数。

  ```input1
  5 8
  2 3
  4 5
  0 0
  0 0
  0 0
  1 1 1
  1 2 2
  1 3 3
  2 2
  3 4
  2 1
  2 2
  3 4
  ```

  ```output1
  0.250000
  1.000000
  ```

  树的结构如下：

  ```
        1
       / \
      2   3
     / \
    4   5
  ```

  前 $4$ 个操作完后的 `lazytag`：`1 0 3 2 2`。

  此时查询 $4$。下传节点 $1$，有 $\frac{1}{2}$  的概率传对，此时节点 $2$ 的 `lazytag` 变成了 $1$，节点 $3$ 的 `lazytag` 变成了 $4$，下传节点 $2$，有 $\frac{1}{2}$ 的概率传对，此时就到了节点 $4$，正确概率为 $\frac{1}{2}\times\frac{1}{2}=\frac{1}{4}$。

  注意传完后要把 `lazytag` 变回：`1 0 3 2 2`。

  第二个询问时 $1,2$ 的 `lazytag` 都成了 $0$ 一定不会错。

  ```input2
  5 9
  2 3
  4 5
  0 0
  0 0
  0 0
  1 1 111
  1 2 123
  1 3 456
  2 2
  3 4
  2 1
  2 2
  1 1 987
  3 4
  ```

  ```output2
  0.982223
  0.997977
  ```

  ## 数据范围

  + 对于 $10\%$ 的数据 $,n,m\le10$；
  + 对于 $40\%$ 的数据 $,n,m\le10^3$；
  + 对于 $100\%$ 的数据 $,n,m\le10^5$；
  + 保证树随机生成，且任意时刻 `lazytag` 非负。